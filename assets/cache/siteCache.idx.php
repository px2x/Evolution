<?php
$c=&$this->config;$c['settings_version']="1.4.0.RC2";$c['manager_theme']="default";$c['server_offset_time']="0";$c['manager_language']="russian-UTF8";$c['modx_charset']="UTF-8";$c['site_name']="My Evolution Site";$c['site_start']="1";$c['error_page']="1";$c['unauthorized_page']="1";$c['site_status']="1";$c['auto_template_logic']="parent";$c['default_template']="3";$c['old_template']="3";$c['publish_default']="1";$c['friendly_urls']="1";$c['friendly_alias_urls']="1";$c['use_alias_path']="1";$c['cache_type']="2";$c['failed_login_attempts']="3";$c['blocked_minutes']="60";$c['use_captcha']="0";$c['emailsender']="";$c['use_editor']="1";$c['use_browser']="1";$c['fe_editor_lang']="russian-UTF8";$c['fck_editor_toolbar']="standard";$c['fck_editor_autolang']="0";$c['editor_css_path']="";$c['editor_css_selectors']="";$c['upload_maxsize']="10485760";$c['manager_layout']="4";$c['auto_menuindex']="1";$c['session.cookie.lifetime']="604800";$c['mail_check_timeperiod']="600";$c['manager_direction']="ltr";$c['xhtml_urls']="0";$c['automatic_alias']="1";$c['datetime_format']="dd-mm-YYYY";$c['warning_visibility']="0";$c['remember_last_tab']="1";$c['enable_bindings']="1";$c['seostrict']="1";$c['number_of_results']="30";$c['theme_refresher']="";$c['show_picker']="0";$c['show_newresource_btn']="0";$c['show_fullscreen_btn']="0";$c['site_id']="5a32792691ebe";$c['site_unavailable_page']="";$c['reload_site_unavailable']="";$c['site_unavailable_message']="В настоящее время сайт недоступен.";$c['siteunavailable_message_default']="В настоящее время сайт недоступен.";$c['enable_filter']="0";$c['enable_at_syntax']="1";$c['cache_default']="1";$c['search_default']="1";$c['custom_contenttype']="application/rss+xml,application/pdf,application/vnd.ms-word,application/vnd.ms-excel,text/html,text/css,text/xml,text/javascript,text/plain,application/json";$c['docid_incrmnt_method']="0";$c['enable_cache']="1";$c['minifyphp_incache']="0";$c['server_protocol']="http";$c['rss_url_news']="http://feeds.feedburner.com/evocms-release-news";$c['track_visitors']="0";$c['top_howmany']="10";$c['friendly_url_prefix']="";$c['friendly_url_suffix']=".html";$c['make_folders']="1";$c['aliaslistingfolder']="0";$c['allow_duplicate_alias']="0";$c['use_udperms']="1";$c['udperms_allowroot']="0";$c['email_method']="mail";$c['smtp_auth']="0";$c['smtp_secure']="none";$c['smtp_host']="smtp.example.com";$c['smtp_port']="25";$c['smtp_username']="you@example.com";$c['reload_emailsubject']="";$c['emailsubject']="Данные для авторизации";$c['emailsubject_default']="Данные для авторизации";$c['reload_signupemail_message']="";$c['signupemail_message']="Здравствуйте, [+uid+]!\r\n\r\nВаши данные для авторизации в системе управления сайтом [+sname+]:\r\n\r\nИмя пользователя: [+uid+]\r\nПароль: [+pwd+]\r\n\r\nПосле успешной авторизации в системе управления сайтом ([+surl+]), вы сможете изменить свой пароль.\r\n\r\nС уважением, Администрация";$c['system_email_signup_default']="Здравствуйте, [+uid+]!\r\n\r\nВаши данные для авторизации в системе управления сайтом [+sname+]:\r\n\r\nИмя пользователя: [+uid+]\r\nПароль: [+pwd+]\r\n\r\nПосле успешной авторизации в системе управления сайтом ([+surl+]), вы сможете изменить свой пароль.\r\n\r\nС уважением, Администрация";$c['reload_websignupemail_message']="";$c['websignupemail_message']="Здравствуйте, [+uid+]!\r\n\r\nВаши данные для авторизации на [+sname+]:\r\n\r\nИмя пользователя: [+uid+]\r\nПароль: [+pwd+]\r\n\r\nПосле успешной авторизации на [+sname+] ([+surl+]), вы сможете изменить свой пароль.\r\n\r\nС уважением, Администрация";$c['system_email_websignup_default']="Здравствуйте, [+uid+]!\r\n\r\nВаши данные для авторизации на [+sname+]:\r\n\r\nИмя пользователя: [+uid+]\r\nПароль: [+pwd+]\r\n\r\nПосле успешной авторизации на [+sname+] ([+surl+]), вы сможете изменить свой пароль.\r\n\r\nС уважением, Администрация";$c['reload_system_email_webreminder_message']="";$c['webpwdreminder_message']="Здравствуйте, [+uid+]!\r\n\r\nЧтобы активировать ваш новый пароль, перейдите по следующей ссылке:\r\n\r\n[+surl+]\r\n\r\nПозже вы сможете использовать следующий пароль для авторизации: [+pwd+]\r\n\r\nЕсли это письмо пришло к вам по ошибке, пожалуйста, проигнорируйте его.\r\n\r\nС уважением, Администрация";$c['system_email_webreminder_default']="Здравствуйте, [+uid+]!\r\n\r\nЧтобы активировать ваш новый пароль, перейдите по следующей ссылке:\r\n\r\n[+surl+]\r\n\r\nПозже вы сможете использовать следующий пароль для авторизации: [+pwd+]\r\n\r\nЕсли это письмо пришло к вам по ошибке, пожалуйста, проигнорируйте его.\r\n\r\nС уважением, Администрация";$c['tree_page_click']="27";$c['use_breadcrumbs']="0";$c['global_tabs']="0";$c['group_tvs']="0";$c['resource_tree_node_name']="pagetitle";$c['session_timeout']="15";$c['tree_show_protected']="0";$c['datepicker_offset']="-10";$c['number_of_logs']="100";$c['number_of_messages']="40";$c['which_editor']="TinyMCE4";$c['tinymce4_theme']="custom";$c['tinymce4_skin']="lightgray";$c['tinymce4_template_docs']="";$c['tinymce4_template_chunks']="";$c['tinymce4_entermode']="p";$c['tinymce4_element_format']="xhtml";$c['tinymce4_schema']="html5";$c['tinymce4_custom_plugins']="advlist autolink lists link image charmap print preview hr anchor pagebreak searchreplace wordcount visualblocks visualchars code fullscreen spellchecker insertdatetime media nonbreaking save table contextmenu directionality emoticons template paste textcolor codesample colorpicker textpattern imagetools paste modxlink youtube";$c['tinymce4_custom_buttons1']="undo redo | cut copy paste | searchreplace | bold italic underline strikethrough | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent blockquote | styleselect";$c['tinymce4_custom_buttons2']="link unlink anchor image media codesample table | hr removeformat | subscript superscript charmap | nonbreaking | visualchars visualblocks print preview fullscreen code formatselect";$c['tinymce4_custom_buttons3']="";$c['tinymce4_custom_buttons4']="";$c['tinymce4_blockFormats']="Paragraph=p;Header 1=h1;Header 2=h2;Header 3=h3";$c['allow_eval']="with_scan";$c['safe_functions_at_eval']="time,date,strtotime,strftime";$c['check_files_onlogin']="index.php\r\n.htaccess\r\nmanager/index.php\r\nmanager/includes/config.inc.php";$c['validate_referer']="1";$c['rss_url_security']="http://feeds.feedburner.com/evocms-security-news";$c['error_reporting']="2";$c['send_errormail']="0";$c['pwd_hash_algo']="UNCRYPT";$c['reload_captcha_words']="";$c['captcha_words']="EVO,Access,Better,BitCode,Chunk,Cache,Desc,Design,Excell,Enjoy,URLs,TechView,Gerald,Griff,Humphrey,Holiday,Intel,Integration,Joystick,Join(),Oscope,Genetic,Light,Likeness,Marit,Maaike,Niche,Netherlands,Ordinance,Oscillo,Parser,Phusion,Query,Question,Regalia,Righteous,Snippet,Sentinel,Template,Thespian,Unity,Enterprise,Verily,Tattoo,Veri,Website,WideWeb,Yap,Yellow,Zebra,Zygote";$c['captcha_words_default']="EVO,Access,Better,BitCode,Chunk,Cache,Desc,Design,Excell,Enjoy,URLs,TechView,Gerald,Griff,Humphrey,Holiday,Intel,Integration,Joystick,Join(),Oscope,Genetic,Light,Likeness,Marit,Maaike,Niche,Netherlands,Ordinance,Oscillo,Parser,Phusion,Query,Question,Regalia,Righteous,Snippet,Sentinel,Template,Thespian,Unity,Enterprise,Verily,Tattoo,Veri,Website,WideWeb,Yap,Yellow,Zebra,Zygote";$c['filemanager_path']="C:/OSPanel/domains/Evolution/";$c['upload_files']="bmp,ico,gif,jpeg,jpg,png,psd,tif,tiff,fla,flv,swf,aac,au,avi,css,cache,doc,docx,gz,gzip,htaccess,htm,html,js,mp3,mp4,mpeg,mpg,ods,odp,odt,pdf,ppt,pptx,rar,tar,tgz,txt,wav,wmv,xls,xlsx,xml,z,zip,JPG,JPEG,PNG,GIF,svg";$c['upload_images']="bmp,ico,gif,jpeg,jpg,png,psd,tif,tiff,svg";$c['upload_media']="au,avi,mp3,mp4,mpeg,mpg,wav,wmv";$c['upload_flash']="fla,flv,swf";$c['new_file_permissions']="0644";$c['new_folder_permissions']="0755";$c['which_browser']="mcpuk";$c['rb_webuser']="0";$c['rb_base_dir']="C:/OSPanel/domains/Evolution/assets/";$c['rb_base_url']="assets/";$c['clean_uploaded_filename']="1";$c['strip_image_paths']="1";$c['maxImageWidth']="2600";$c['maxImageHeight']="2200";$c['thumbWidth']="150";$c['thumbHeight']="150";$c['thumbsDir']=".thumbs";$c['jpegQuality']="90";$c['denyZipDownload']="0";$c['denyExtensionRename']="0";$c['showHiddenFiles']="0";$c['lang_code']="ru";$c['sys_files_checksum']="a:4:{s:38:\"C:/OSPanel/domains/Evolution/index.php\";s:32:\"c3eae897837b547d501064f641a1d0e3\";s:38:\"C:/OSPanel/domains/Evolution/.htaccess\";s:32:\"b1c95a3066c8f67a50735856c271c60f\";s:46:\"C:/OSPanel/domains/Evolution/manager/index.php\";s:32:\"863a96f261fe95da8b2a549002172c37\";s:60:\"C:/OSPanel/domains/Evolution/manager/includes/config.inc.php\";s:32:\"cab447d50245713fbb0d37e7fb2e49f0\";}";$this->aliasListing=array();$a=&$this->aliasListing;$d=&$this->documentListing;$m=&$this->documentMap;$a[1]=array('id'=>1,'alias'=>'minimal-base','path'=>'','parent'=>0,'isfolder'=>0,'alias_visible'=>1);$d['minimal-base']=1;$m[]=array(0=>1);$a[2]=array('id'=>2,'alias'=>'test','path'=>'','parent'=>0,'isfolder'=>0,'alias_visible'=>1);$d['test']=2;$m[]=array(0=>2);$a[3]=array('id'=>3,'alias'=>'catalog','path'=>'','parent'=>0,'isfolder'=>1,'alias_visible'=>1);$d['catalog']=3;$m[]=array(0=>3);$a[16]=array('id'=>16,'alias'=>'system','path'=>'','parent'=>0,'isfolder'=>1,'alias_visible'=>0);$d['system']=16;$m[]=array(0=>16);$a[4]=array('id'=>4,'alias'=>'kompyutery-i-periferiya','path'=>'catalog','parent'=>3,'isfolder'=>1,'alias_visible'=>1);$d['catalog/kompyutery-i-periferiya']=4;$m[]=array(3=>4);$a[5]=array('id'=>5,'alias'=>'komplektuyushhie-dlya-pk','path'=>'catalog','parent'=>3,'isfolder'=>1,'alias_visible'=>1);$d['catalog/komplektuyushhie-dlya-pk']=5;$m[]=array(3=>5);$a[6]=array('id'=>6,'alias'=>'televizory-i-media','path'=>'catalog','parent'=>3,'isfolder'=>1,'alias_visible'=>1);$d['catalog/televizory-i-media']=6;$m[]=array(3=>6);$a[7]=array('id'=>7,'alias'=>'kabeli','path'=>'catalog/kompyutery-i-periferiya','parent'=>4,'isfolder'=>1,'alias_visible'=>1);$d['catalog/kompyutery-i-periferiya/kabeli']=7;$m[]=array(4=>7);$a[8]=array('id'=>8,'alias'=>'kompyutery','path'=>'catalog/kompyutery-i-periferiya','parent'=>4,'isfolder'=>1,'alias_visible'=>1);$d['catalog/kompyutery-i-periferiya/kompyutery']=8;$m[]=array(4=>8);$a[9]=array('id'=>9,'alias'=>'monitory','path'=>'catalog/kompyutery-i-periferiya','parent'=>4,'isfolder'=>1,'alias_visible'=>1);$d['catalog/kompyutery-i-periferiya/monitory']=9;$m[]=array(4=>9);$a[10]=array('id'=>10,'alias'=>'processory','path'=>'catalog/komplektuyushhie-dlya-pk','parent'=>5,'isfolder'=>1,'alias_visible'=>1);$d['catalog/komplektuyushhie-dlya-pk/processory']=10;$m[]=array(5=>10);$a[11]=array('id'=>11,'alias'=>'materinskie-platy','path'=>'catalog/komplektuyushhie-dlya-pk','parent'=>5,'isfolder'=>1,'alias_visible'=>1);$d['catalog/komplektuyushhie-dlya-pk/materinskie-platy']=11;$m[]=array(5=>11);$a[12]=array('id'=>12,'alias'=>'videokarty','path'=>'catalog/komplektuyushhie-dlya-pk','parent'=>5,'isfolder'=>1,'alias_visible'=>1);$d['catalog/komplektuyushhie-dlya-pk/videokarty']=12;$m[]=array(5=>12);$a[13]=array('id'=>13,'alias'=>'televizory','path'=>'catalog/televizory-i-media','parent'=>6,'isfolder'=>1,'alias_visible'=>1);$d['catalog/televizory-i-media/televizory']=13;$m[]=array(6=>13);$a[14]=array('id'=>14,'alias'=>'proektory','path'=>'catalog/televizory-i-media','parent'=>6,'isfolder'=>1,'alias_visible'=>1);$d['catalog/televizory-i-media/proektory']=14;$m[]=array(6=>14);$a[15]=array('id'=>15,'alias'=>'sputnikovoe-oborudovanie','path'=>'catalog/televizory-i-media','parent'=>6,'isfolder'=>1,'alias_visible'=>1);$d['catalog/televizory-i-media/sputnikovoe-oborudovanie']=15;$m[]=array(6=>15);$a[17]=array('id'=>17,'alias'=>'ajax','path'=>'','parent'=>16,'isfolder'=>1,'alias_visible'=>1);$d['ajax']=17;$m[]=array(16=>17);$a[18]=array('id'=>18,'alias'=>'adm','path'=>'ajax','parent'=>17,'isfolder'=>1,'alias_visible'=>1);$d['ajax/adm']=18;$m[]=array(17=>18);$c=&$this->contentTypes;$c=&$this->chunkCache;$c['mm_rules']='// more example rules are in assets/plugins/managermanager/example_mm_rules.inc.php
// example of how PHP is allowed - check that a TV named documentTags exists before creating rule

if ($modx->db->getValue($modx->db->select(\'count(id)\', $modx->getFullTableName(\'site_tmplvars\'), "name=\'documentTags\'"))) {
	mm_widget_tags(\'documentTags\', \' \'); // Give blog tag editing capabilities to the \'documentTags (3)\' TV
}
mm_widget_showimagetvs(); // Always give a preview of Image TVs

mm_createTab(\'SEO\', \'seo\', \'\', \'\', \'\', \'\');
mm_moveFieldsToTab(\'titl,keyw,desc,seoOverride,noIndex,sitemap_changefreq,sitemap_priority,sitemap_exclude\', \'seo\', \'\', \'\');
mm_widget_tags(\'keyw\',\',\'); // Give blog tag editing capabilities to the \'documentTags (3)\' TV


//mm_createTab(\'Images\', \'photos\', \'\', \'\', \'\', \'850\');
//mm_moveFieldsToTab(\'images,photos\', \'photos\', \'\', \'\');

//mm_hideFields(\'longtitle,description,link_attributes,menutitle,content\', \'\', \'6,7\');

//mm_hideTemplates(\'0,5,8,9,11,12\', \'2,3\');

//mm_hideTabs(\'settings, access\', \'2\');
';$c['head']='<head>
    <!--[if lt IE 9]!><script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
    <!--[if lt IE 9]>
        <script src="http://css3-mediaqueries-js.googlecode.com/svn/trunk/css3-mediaqueries.js"></script>
    <![endif]-->
    <base href="[(site_url)]" />
	<link rel="canonical" href="[(site_url)][!if? &is=`[*id*]:eq:1` &then=`` &else=`[~[*id*]~]` !]" />
	
    <title>[*pagetitle*]</title>
    <meta name="description" lang="ru" content="[*descr*]" />
    <meta name="keywords" lang="ru" content="[*keywords*]" />
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="favicon.ico" type="image/x-icon" />
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
	
	<!-- Стили, скрипты и шрифты пока пусть будут тут -->
	<link href="https://fonts.googleapis.com/css?family=Oswald:200,300,400,500,600,700&amp;subset=cyrillic" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="template/css/style.css" />
    <!-- <link rel="stylesheet" type="text/css" href="template/css/responsive.css" /> -->
	<!-- <link rel="stylesheet" type="text/css" href="template/css/catalogfilter.css" /> -->
	<!-- <link rel="stylesheet" type="text/css" href="template/css/jquery.fancybox.min.css" /> -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
	<script src="http://rubaxa.github.io/Sortable/Sortable.js"></script>
</head>';$c['header']=' <header>
 	<div class="wrapper">
 		<img src="" alt="" class="logo" alt="LOGO" title="LOGO">
		<div class="contacts">CONTACTS</div>
		<div class="clr"></div>
 	</div>
 </header>';$c['topmenu']='<div class="topmenu">
	<div class="wrapper">
		<nav>
			<ul>
				<li><a href="#">LINK</a></li>
				<li><a href="#">LINK</a></li>
				<li><a href="#">LINK</a></li>
				<li><a href="#">LINK</a></li>
				<li><a href="#">LINK</a></li>
			</ul>
		</nav>
		<div class="search">SEARCH</div>
		<div class="clr"></div>
	</div>
</div>';$c['slider']='<section class="slider">
    <ul class="bxslider">
      	<li style="background-image: url(template/image/pic1.jpg)">
      	    <div class="sliderTit">Lorem ipsum
				<span class="sliderSubT">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolorem voluptatum fugit quod consectetur voluptate dolores.</span>
			</div>
      	</li>
		
		<li style="background-image: url(template/image/pic2.jpg)">
      	    <div class="sliderTit">Lorem ipsum
				<span class="sliderSubT">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolorem voluptatum fugit quod consectetur voluptate dolores.</span>
			</div>
      	</li>

		<li style="background-image: url(template/image/pic3.jpg)">
      	    <div class="sliderTit">Lorem ipsum
				<span class="sliderSubT">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolorem voluptatum fugit quod consectetur voluptate dolores.</span>
			</div>
      	</li>
		
		<li style="background-image: url(template/image/pic4.jpg)">
      	    <div class="sliderTit">Lorem ipsum
				<span class="sliderSubT">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolorem voluptatum fugit quod consectetur voluptate dolores.</span>
			</div>
      	</li>
		
    </ul>
</section>';$c['scripts']='<script src="template/js/common.js"></script>
<script src="template/js/jquery.bxslider.js"></script>';$c['footer']='<footer>
	FOOTER
</footer>';$c['test_cat']='<div class="item">
	<div class="image">[+px.image+]</div>
	<div class="title">[+px.pagetitle+]</div>
	<!-- <div class="link">[~[+px.id+]F~]</div> -->
	<div class="link"><a href="[~[+px.id+]~]">[~[+px.id+]~]</a></div>
</div>
';$c['test_good']='<div class="item">
	<div class="image">[+px.istCardPage+]</div>
	<div class="image">[+px.id_product+]</div>
	<div class="title">[+px.name+]</div>
	<!-- <div class="link">[~[+px.id+]F~]</div> -->
	<div class="link"><a href="[+px.path+]">[+px.path+]</a></div>
</div>
';$c['test_card']='<div class="item">
	<div class="image">[+px.istCardPage+]</div>
	<div class="image">[+px.id_product+]</div>
	<div class="title">[+px.name+]</div>
	<!-- <div class="link">[~[+px.id+]F~]</div> -->
	<div class="link"><a href="[+px.path+]">[+px.path+]</a></div>
</div>
';$c['ProductRedactor']='<link rel="stylesheet" type="text/css" href="template/css/deltaEdits.css" />
<script src="template/js/deltaEdits.js"></script>


<script type="text/javascript" src="assets/plugins/tinymce4/tinymce/jquery.tinymce.min.js"></script>
<script type="text/javascript" src="assets/plugins/tinymce4/tinymce/tinymce.min.js"></script>

<div class="deltaEPCont" id="viEditForm">Добавить</div>

<div class="deltaEditProduct" id="deltaEditProduct" data-productid="[+px.idPage+]">
	
	<div class="tabs">
        <div class="tab active" data-tabid="1" data-hash="main">Основные</div>
		<div class="tab" data-tabid="2" data-hash="photo">Фотографии</div>
        <div class="tab" data-tabid="3" data-hash="props">Свойства</div>
        <div class="tab" data-tabid="4" data-hash="prices">Цены</div>
		<div class="tab" data-tabid="5" data-hash="seo">SEO</div>
    </div>
	
	<div class="tabContent">
		
		
            <div class="cont active" data-tabid="1">
             
				
				<div class="oneInut">
					<input type="text" name="name" value="[+px.name+]" id="g_name"/>
					<label for="g_name">Название</label>
				</div>
				
				
				<div class="oneInut">
					<input type="text" name="intro" value="[+px.intro+]" id="g_intro"/>
					<label for="g_intro">Краткое описание</label>
				</div>
				
				
				<div class="oneInut">
					<!-- TinyMCE -->
					<script type="text/javascript">
					tinyMCE.init({
						mode : "exact",
						elements: "content_editor",
						theme : "modern",
						language:"ru",
						elements: "content_editor"
					 });
					</script>
					<!-- /TinyMCE -->
					<textarea name="description" id="content_editor">[+px.description+]</textarea>
				</div>
				
				
					

            </div>
			
			
            <div class="cont" data-tabid="2">
				
			    <label class="file_upload">
				   <span class="button">Выбрать файлы</span>
				   <mark>Файлы не выбраны</mark>
				   <input type="file" name="xFile" id="uploaded_file" multiple="false" accept=".jpg,.png,.gif,.webp,.jpeg,.bmp,.wbmp">
			    </label>
				
				<div class="imagelist" id="dloadImageList">
					[!getImage? &type=`all` &tpl=`admImageList` &id=`[+px.idPage+]`!]
				</div>
				
				
	
	
            </div>
			
		
		
			
            <div class="cont" data-tabid="3">
				
			
            </div>
		
		
		    <div class="cont" data-tabid="4">
				
			
            </div>
		
				
		    <div class="cont" data-tabid="4">
				
			
            </div>
		
		<div class="controls">
			<button class="dControl save">Сохранить</button>
			<button class="dControl accept">Применить</button>
			<button class="dControl cancel">Отменить</button>
		</div>
		
		
		
    </div>
	
</div>';$c['admImageList']='<span class="imgprogress">
	<img class="thumb" src="[+px.link+]" alt="[+px.alt+]" title="[+px.title+]" data-position="[+px.position+]">
</span>';$s=&$this->snippetCache;$s['DLCrumbs']='return require MODX_BASE_PATH.\'assets/snippets/DocLister/snippet.DLCrumbs.php\';';$s['DLMenu']='return require MODX_BASE_PATH.\'assets/snippets/DocLister/snippet.DLMenu.php\';';$s['DLSitemap']='return require MODX_BASE_PATH.\'assets/snippets/DocLister/snippet.DLSitemap.php\';';$s['DocInfo']='return require MODX_BASE_PATH.\'assets/snippets/docinfo/snippet.docinfo.php\';';$s['DocLister']='return require MODX_BASE_PATH.\'assets/snippets/DocLister/snippet.DocLister.php\';';$s['FormLister']='return require MODX_BASE_PATH.\'assets/snippets/FormLister/snippet.FormLister.php\';';$s['if']='return require MODX_BASE_PATH.\'assets/snippets/if/snippet.if.php\';';$s['phpthumb']='return require MODX_BASE_PATH.\'assets/snippets/phpthumb/snippet.phpthumb.php\';';$s['summary']='return require MODX_BASE_PATH.\'assets/snippets/summary/snippet.summary.php\';';$s['DLT_CATALOG']='if (!is_numeric($root)){
	$root= $modx->documentIdentifier;
}


 
//$catalog = new catalog_c($modx);

//echo \'ww\'.$modx->urlXParams[\'istCardPage\']."ww";

if ($modx->urlXParams[\'istCardPage\'] != true) {
	$modx->c->getCatFromID($root);
	$modx->c->getCatFromID($root)->getCatFields()->sortIt(\'cats\', \'menuindex\', \'DESC\');
	$modx->c->renderAll($chunkCats , \'cats\' , \'print\');
}



if ($modx->urlXParams[\'istCardPage\'] != true) {
	$modx->c->getGoodsFromCats ($root ,false, /*$modx->parseXparams()*/ false , true );
	$modx->c->getAllGoodFields();
	$modx->c->renderAll($chunkGoods , \'goods\' , \'print\'); 
}
//$modx->c->getGoodsFromCats ($root ,false, /*$modx->parseXparams()*/ false , true );




if ($modx->urlXParams[\'istCardPage\'] == true) {
	//$modx->c->set($modx->urlXParams[\'idPage\']);
	//print_r($modx->c->getFields($modx->urlXParams[\'idPage\']) );
	$modx->c->render($chunkCard , $modx->c->getFields($modx->urlXParams[\'idPage\'])[$modx->urlXParams[\'idPage\']]  , \'print\'); 
}



//echo $modx->pre($modx->c->getArrayData(\'cats\'));


/*
$catalog = $modx->getCatFromID($root);
$catalog->getFields()->sortIt(\'cats\', \'menuindex\', \'DESC\')->sliceIt(\'cats\' , 0, 2);
*/



//$catalog->getCatFromID($root)->getFields()->sortIt(\'cats\', \'menuindex\', \'DESC\');

//$catalog->renderAll($chunkCats , \'cats\' , \'print\');





//$modx->getGoodsFromCats ($root ,false, /*$modx->parseXparams()*/ false , true );
//$modx->getAllGoodFields();
/*
$modx->renderAll($chunkGoods , \'goods\' , \'print\');

echo $modx->pre($modx->getArrayData(\'goods\'));

/
	
	
	
/*
$idsF = $modx->getArrayData(\'cats\');
echo $modx->pre($idsF);
*/';$s['admAJX']='$headers = getallheaders();

if ($headers[\'xDltFetching\'] == \'true\'){

	
	if (RQ::P(\'event\') == \'addOrUpdate\') {
		if ($response[\'che\'] = $modx->c->checkExists(RQ::P(\'id_product\'))){
			$response[\'evt\'] =  \'update\';
			$response[\'state\'] =  $modx->c->updateGoods(RQ::P(\'id_product\'));
		}else {
			$response[\'evt\'] = \'create\';
		}
	}







	if (RQ::G(\'event\') == \'uploadimages\') {
		$response = $modx->c->uploadImages();
	}



	
	
}
	
return json_encode($response);';$s['getImage']='return $modx->c->renderList($tpl, $modx->c->getImages($id) , \'print\' );';$p=&$this->pluginCache;$p['CodeMirror']='/**
 * CodeMirror
 *
 * JavaScript library that can be used to create a relatively pleasant editor interface based on CodeMirror 5.12
 *
 * @category    plugin
 * @version     1.4
 * @license     http://www.gnu.org/copyleft/gpl.html GNU Public License (GPL)
 * @package     modx
 * @internal    @events OnDocFormRender,OnChunkFormRender,OnModFormRender,OnPluginFormRender,OnSnipFormRender,OnTempFormRender,OnRichTextEditorInit
 * @internal    @modx_category Manager and Admin
 * @internal    @properties &theme=Theme;list;default,ambiance,blackboard,cobalt,eclipse,elegant,erlang-dark,lesser-dark,midnight,monokai,neat,night,one-dark,rubyblue,solarized,twilight,vibrant-ink,xq-dark,xq-light;default &darktheme=Dark Theme;list;default,ambiance,blackboard,cobalt,eclipse,elegant,erlang-dark,lesser-dark,midnight,monokai,neat,night,one-dark,rubyblue,solarized,twilight,vibrant-ink,xq-dark,xq-light;one-dark &fontSize=Font-size;list;10,11,12,13,14,15,16,17,18;14 &lineHeight=Line-height;list;1,1.1,1.2,1.3,1.4,1.5;1.3 &indentUnit=Indent unit;int;4 &tabSize=The width of a tab character;int;4 &lineWrapping=lineWrapping;list;true,false;true &matchBrackets=matchBrackets;list;true,false;true &activeLine=activeLine;list;true,false;false &emmet=emmet;list;true,false;true &search=search;list;true,false;false &indentWithTabs=indentWithTabs;list;true,false;true &undoDepth=undoDepth;int;200 &historyEventDelay=historyEventDelay;int;1250
 * @internal    @installset base
 * @reportissues https://github.com/evolution-cms/evolution
 * @documentation Official docs https://codemirror.net/doc/manual.html
 * @author      hansek from http://www.modxcms.cz
 * @author      update Mihanik71
 * @author      update Deesen
 * @author      update 64j
 * @lastupdate  3/07/2017
 */

$_CM_BASE = \'assets/plugins/codemirror/\';

$_CM_URL = $modx->config[\'site_url\'] . $_CM_BASE;

require(MODX_BASE_PATH. $_CM_BASE .\'codemirror.plugin.php\');';$p['CodeMirrorProps']='{"theme":[{"label":"Theme","type":"list","value":"default","options":"default,ambiance,blackboard,cobalt,eclipse,elegant,erlang-dark,lesser-dark,midnight,monokai,neat,night,one-dark,rubyblue,solarized,twilight,vibrant-ink,xq-dark,xq-light","default":"default","desc":""}],"darktheme":[{"label":"Dark Theme","type":"list","value":"one-dark","options":"default,ambiance,blackboard,cobalt,eclipse,elegant,erlang-dark,lesser-dark,midnight,monokai,neat,night,one-dark,rubyblue,solarized,twilight,vibrant-ink,xq-dark,xq-light","default":"one-dark","desc":""}],"fontSize":[{"label":"Font-size","type":"list","value":"14","options":"10,11,12,13,14,15,16,17,18","default":"14","desc":""}],"lineHeight":[{"label":"Line-height","type":"list","value":"1.3","options":"1,1.1,1.2,1.3,1.4,1.5","default":"1.3","desc":""}],"indentUnit":[{"label":"Indent unit","type":"int","value":"4","default":"4","desc":""}],"tabSize":[{"label":"The width of a tab character","type":"int","value":"4","default":"4","desc":""}],"lineWrapping":[{"label":"lineWrapping","type":"list","value":"true","options":"true,false","default":"true","desc":""}],"matchBrackets":[{"label":"matchBrackets","type":"list","value":"true","options":"true,false","default":"true","desc":""}],"activeLine":[{"label":"activeLine","type":"list","value":"false","options":"true,false","default":"false","desc":""}],"emmet":[{"label":"emmet","type":"list","value":"true","options":"true,false","default":"true","desc":""}],"search":[{"label":"search","type":"list","value":"false","options":"true,false","default":"false","desc":""}],"indentWithTabs":[{"label":"indentWithTabs","type":"list","value":"true","options":"true,false","default":"true","desc":""}],"undoDepth":[{"label":"undoDepth","type":"int","value":"200","default":"200","desc":""}],"historyEventDelay":[{"label":"historyEventDelay","type":"int","value":"1250","default":"1250","desc":""}]}';$p['ElementsInTree']='require MODX_BASE_PATH.\'assets/plugins/elementsintree/plugin.elementsintree.php\';';$p['ElementsInTreeProps']='{
  "adminRoleOnly": [
    {
      "label": "Administrators only",
      "type": "list",
      "value": "yes",
      "options": "yes,no",
      "default": "yes",
      "desc": ""
    }
  ],
  "treeButtonsInTab": [
    {
      "label": "Tree buttons in tab",
      "type": "list",
      "value": "yes",
      "options": "yes,no",
      "default": "yes",
      "desc": ""
    }
  ]
}';$p['FileSource']='require MODX_BASE_PATH.\'assets/plugins/filesource/plugin.filesource.php\';';$p['Forgot Manager Login']='require MODX_BASE_PATH.\'assets/plugins/forgotmanagerlogin/plugin.forgotmanagerlogin.php\';';$p['ManagerManager']='/**
 * ManagerManager
 *
 * Customize the EVO Manager to offer bespoke admin functions for end users or manipulate the display of document fields in the manager.
 *
 * @category plugin
 * @version 0.6.2
 * @license http://creativecommons.org/licenses/GPL/2.0/ GNU Public License (GPL v2)
 * @internal @properties &remove_deprecated_tv_types_pref=Remove deprecated TV types;list;yes,no;yes &config_chunk=Configuration Chunk;text;mm_rules
 * @internal @events OnDocFormRender,OnDocFormPrerender,OnBeforeDocFormSave,OnDocFormSave,OnDocDuplicate,OnPluginFormRender,OnTVFormRender
 * @internal @modx_category Manager and Admin
 * @internal @installset base
 * @internal @legacy_names Image TV Preview, Show Image TVs
 * @reportissues https://github.com/DivanDesign/MODXEvo.plugin.ManagerManager/
 * @documentation README [+site_url+]assets/plugins/managermanager/readme.html
 * @documentation Official docs http://code.divandesign.biz/modx/managermanager
 * @link        Latest version http://code.divandesign.biz/modx/managermanager
 * @link        Additional tools http://code.divandesign.biz/modx
 * @link        Full changelog http://code.divandesign.biz/modx/managermanager/changelog
 * @author      Inspired by: HideEditor plugin by Timon Reinhard and Gildas; HideManagerFields by Brett @ The Man Can!
 * @author      DivanDesign studio http://www.DivanDesign.biz
 * @author      Nick Crossland http://www.rckt.co.uk
 * @author      Many others
 * @lastupdate  06/03/2016
 */

// Run the main code
include($modx->config[\'base_path\'].\'assets/plugins/managermanager/mm.inc.php\');';$p['ManagerManagerProps']='{"remove_deprecated_tv_types_pref":[{"label":"Remove deprecated TV types","type":"list","value":"yes","options":"yes,no","default":"yes","desc":""}],"config_chunk":[{"label":"Configuration Chunk","type":"text","value":"mm_rules","default":"mm_rules","desc":""}]}';$p['TinyMCE4']='require MODX_BASE_PATH.\'assets/plugins/tinymce4/plugin.tinymce.php\';';$p['TinyMCE4Props']='{"styleFormats":[{"label":"Custom Style Formats <b>RAW<\\/b><br\\/><br\\/><ul><li>leave empty to use below block\\/inline formats<\\/li><li>allows simple-format: <i>Title,cssClass|Title2,cssClass2<\\/i><\\/li><li>Also accepts full JSON-config as per TinyMCE4 docs \\/ configure \\/ content-formating \\/ style_formats<\\/li><\\/ul>","type":"textarea","value":"","default":"","desc":""}],"styleFormats_inline":[{"label":"Custom Style Formats <b>INLINE<\\/b><br\\/><br\\/><ul><li>will wrap selected text with span-tag + css-class<\\/li><li>simple-format only<\\/li><\\/ul>","type":"textarea","value":"InlineTitle,cssClass1|InlineTitle2,cssClass2","default":"InlineTitle,cssClass1|InlineTitle2,cssClass2","desc":""}],"styleFormats_block":[{"label":"Custom Style Formats <b>BLOCK<\\/b><br\\/><br\\/><ul><li>will add css-class to selected block-element<\\/li><li>simple-format only<\\/li><\\/ul>","type":"textarea","value":"BlockTitle,cssClass3|BlockTitle2,cssClass4","default":"BlockTitle,cssClass3|BlockTitle2,cssClass4","desc":""}],"customParams":[{"label":"Custom Parameters<br\\/><b>(Be careful or leave empty!)<\\/b>","type":"textarea","value":"","default":"","desc":""}],"entityEncoding":[{"label":"Entity Encoding","type":"list","value":"named","options":"named,numeric,raw","default":"named","desc":""}],"entities":[{"label":"Entities","type":"text","value":"","default":"","desc":""}],"pathOptions":[{"label":"Path Options","type":"list","value":"Site config","options":"Site config,Absolute path,Root relative,URL,No convert","default":"Site config","desc":""}],"resizing":[{"label":"Advanced Resizing","type":"list","value":"false","options":"true,false","default":"false","desc":""}],"disabledButtons":[{"label":"Disabled Buttons","type":"text","value":"","default":"","desc":""}],"webTheme":[{"label":"Web Theme","type":"test","value":"webuser","default":"webuser","desc":""}],"webPlugins":[{"label":"Web Plugins","type":"text","value":"","default":"","desc":""}],"webButtons1":[{"label":"Web Buttons 1","type":"text","value":"bold italic underline strikethrough removeformat alignleft aligncenter alignright","default":"bold italic underline strikethrough removeformat alignleft aligncenter alignright","desc":""}],"webButtons2":[{"label":"Web Buttons 2","type":"text","value":"link unlink image undo redo","default":"link unlink image undo redo","desc":""}],"webButtons3":[{"label":"Web Buttons 3","type":"text","value":"","default":"","desc":""}],"webButtons4":[{"label":"Web Buttons 4","type":"text","value":"","default":"","desc":""}],"webAlign":[{"label":"Web Toolbar Alignment","type":"list","value":"ltr","options":"ltr,rtl","default":"ltr","desc":""}],"width":[{"label":"Width","type":"text","value":"100%","default":"100%","desc":""}],"height":[{"label":"Height","type":"text","value":"400px","default":"400px","desc":""}],"introtextRte":[{"label":"<b>Introtext RTE<\\/b><br\\/>add richtext-features to \\"introtext\\"","type":"list","value":"disabled","options":"enabled,disabled","default":"disabled","desc":""}],"inlineMode":[{"label":"<b>Inline-Mode<\\/b>","type":"list","value":"disabled","options":"enabled,disabled","default":"disabled","desc":""}],"inlineTheme":[{"label":"<b>Inline-Mode<\\/b><br\\/>Theme","type":"text","value":"inline","default":"inline","desc":""}],"browser_spellcheck":[{"label":"<b>Browser Spellcheck<\\/b><br\\/>At least one dictionary must be installed inside your browser","type":"list","value":"disabled","options":"enabled,disabled","default":"disabled","desc":""}],"paste_as_text":[{"label":"<b>Force Paste as Text<\\/b>","type":"list","value":"disabled","options":"enabled,disabled","default":"disabled","desc":""}]}';$p['TransAlias']='require MODX_BASE_PATH.\'assets/plugins/transalias/plugin.transalias.php\';';$p['TransAliasProps']='{"table_name":[{"label":"Trans table","type":"list","value":"russian","options":"common,russian,dutch,german,czech,utf8,utf8lowercase","default":"russian","desc":""}],"char_restrict":[{"label":"Restrict alias to","type":"list","value":"lowercase alphanumeric","options":"lowercase alphanumeric,alphanumeric,legal characters","default":"lowercase alphanumeric","desc":""}],"remove_periods":[{"label":"Remove Periods","type":"list","value":"No","options":"Yes,No","default":"No","desc":""}],"word_separator":[{"label":"Word Separator","type":"list","value":"dash","options":"dash,underscore,none","default":"dash","desc":""}],"override_tv":[{"label":"Override TV name","type":"string","value":"","default":"","desc":""}]}';$p['Updater']='require MODX_BASE_PATH.\'assets/plugins/updater/plugin.updater.php\';';$p['UpdaterProps']='{"version":[{"label":"Version:","type":"text","value":"evolution-cms\\/evolution","default":"evolution-cms\\/evolution","desc":""}],"wdgVisibility":[{"label":"Show widget for:","type":"menu","value":"All","options":"All,AdminOnly,AdminExcluded,ThisRoleOnly,ThisUserOnly","default":"All","desc":""}],"ThisRole":[{"label":"Show only to this role id:","type":"string","value":"","default":"","desc":""}],"ThisUser":[{"label":"Show only to this username:","type":"string","value":"","default":"","desc":""}],"showButton":[{"label":"Show Update Button:","type":"menu","value":"AdminOnly","options":"show,hide,AdminOnly","default":"AdminOnly","desc":""}],"type":[{"label":"Type:","type":"menu","value":"tags","options":"tags,releases,commits","default":"tags","desc":""}]}';$p['test']='$headers = getallheaders();
if ($headers[\'xDltFetching\'] == \'true\') {
	return;
}

echo $modx->pre($modx->urlXParams);

//echo $modx->pre($modx->getCatFromID(3));

//$id= $modx->documentIdentifier;

//$ids = $modx->getTreeCat(4 , false);
	
//$modx->getTreeCat(3);

//$modx->getCatFromID(4)->getFields()->sortIt(\'cats\', \'menuindex\', \'DESC\')->sliceIt(\'cats\' , 1, 2);


//$idsF = $modx->getArrayData(\'cats\');


//$idsF = $modx->getFields();


//$modx->sortGoods (\'menuindex\', \'ASC\');

//$idsF = $modx->sliceGoods ($idsF , 0, 99);

//echo $modx->pre($idsF);



//$modx->getGoodsFromCats (4 ,false, /*$modx->parseXparams()*/ false , true );

//$modx->getAllGoodFields();


//$idsGoods = $modx->getGoodsFromCats ();

//$modx->getAllGoodFields();
	

//echo $modx->pre($modx->getArrayData(\'goods\'));

//echo $modx->pre($modx->urlXParams);';$p['testProps']='{}';$p['syncSnippets']='/**
 * syncSnippets
 *
 * Cинхронизация сниппетов. Использовать ТОЛЬКО при разработке
 *
 * @version   2.0
 * @date      02.02.2018
 * @events    OnWebPageInit,OnSnipFormSave
 *
 */

$conf = array (
		\'path\' => "assets/sync_snippets/"
);

$catList = [];



switch ($modx->event->name) {
    case \'OnWebPageInit\':
        init_px_sync($modx, $conf, $catList);
        break;
    case \'OnSnipFormSave\':
        refreshSNPfile($modx , $conf);
        break;	
}






function refreshSNPfile($modx , $conf){
	$snippetID = $modx->event->params[\'id\'];
	$sql = "SELECT ss.snippet, ss.name , cat.category FROM ".$modx->getFullTableName( \'site_snippets\' )." AS ss 
			LEFT JOIN  ".$modx->getFullTableName( \'categories\' )." AS cat ON cat.id = ss.category
			WHERE ss.id = ".$snippetID;
	
	$result = $modx->db->query($sql);
	if ($result && $modx->db->getRecordCount($result) > 0) {
		if ($row = $modx->db->getRow($result)){
		
			if ($row[\'category\'] == \'\') {
				$snp_path = $conf[\'path\'].$row[\'name\'].\'.php\';
			} else {
				$snp_path = $conf[\'path\'].$row[\'category\'].\'/\'.$row[\'name\'].\'.php\';
			}
			
			$fileHandler = fopen (\'../\'.$snp_path , \'w\');
				
			if ($fileHandler) {
				fwrite($fileHandler , "<?php".PHP_EOL.$row[\'snippet\'].PHP_EOL."?>");
				fclose($fileHandler);
				@unlink(\'../\'.$conf[\'path\'].\'___SyncDATE.log\');
				rewriteLog(\'../\'.$conf[\'path\'] , $conf , true);
				
			}	
		}
	}
}







function init_px_sync ($modx , $conf , &$catList) {
	$sql = "SELECT * FROM ".$modx->getFullTableName( \'categories\' )." LIMIT 50";
	$result = $modx->db->query($sql);
	if ($result && $modx->db->getRecordCount($result) > 0 ) {
		while ($row = $modx->db->getRow($result)){
			$catList[$row[\'id\'] ] = $row[\'category\']; 
		}
	}
	
	$newDirectories = addNewCatToDB($modx , $conf , $catList);
	if ($newDirectories) {
		createNewSnippet($modx , $conf[\'path\'] , $conf);
	}
	
	if (makeDir($catList , $conf)) {
		if (sync($modx , $conf , $catList) === true){
			@unlink($conf[\'path\'].\'___SyncDATE.log\');
			if (rewriteLog($conf[\'path\'] , $conf , false) === true) {
				header("Location: http://".$_SERVER[\'HTTP_HOST\'].$_SERVER[\'REQUEST_URI\']);
			}	
		}
	}
}







function createNewSnippet($modx , $path, $conf) {
	$dirHandler = opendir($path);
	while (($file = readdir($dirHandler)) !== false) {
        if ($file == \'.\' || $file == \'..\' || $file == "___SyncDATE.log") continue;
		
		if (is_dir($path.$file)) {
			//recurssive
			createNewSnippet($modx , $path.$file."/", $conf);
		}elseif (is_file($path.$file)) {
			
			if (!file_exists($path.$file)) return false;
			$fileName = explode(\'.\', $file);
			$fileName = $fileName[0];
			$idCategory = 0;

			$sql = "SELECT id FROM  ".$modx->getFullTableName( \'site_snippets\' )." WHERE name = \'".$fileName."\' ";
			if ($result = $modx->db->query($sql)){
				if ($modx->db->getRecordCount($result) == 0) {
					$pathWay = explode(\'/\' , $path);
					print_r($pathWay);
					if (count($pathWay) > 0){
						
						$rootPath = explode(\'/\', $conf[\'path\']);
						$rootPath = $rootPath[count($rootPath)-2];
						if ($pathWay[count($pathWay)-2] == $rootPath) {
							$idCategory = 0;
						} else {

							$catName = $pathWay[count($pathWay)-2];
							echo \'__\'.$catName.\'<br>\';
							
							$sql = "SELECT id FROM ".$modx->getFullTableName( \'categories\' )." WHERE category = \'".$catName."\' LIMIT 1";
							if ($result = $modx->db->query($sql)) {
								if ($modx->db->getRecordCount($result) > 0){
									if ($row = $modx->db->getRow($result)) {
										$idCategory = $row[\'id\'];
									}
								}
							}
						}

						$snp_code =  file($path.$file);
						$snp_code[0] = \'\';
						$snp_code[count($snp_code) -1 ] = \'\';
						$snp_code = implode("", $snp_code);
						$snp_code = $modx->db->escape($snp_code);
						$sql = "INSERT INTO ".$modx->getFullTableName( \'site_snippets\' )." (name , category , snippet) VALUES (\'".$fileName."\' , \'".$idCategory."\' , \'".$snp_code."\') ";
						$result = $modx->db->query($sql);
						if ($result) {
							//rewriteLog($conf[\'path\'] , $conf);
						}
					}
				}
			}
		}	
	}
}







function addNewCatToDB($modx , $conf, &$catList) {
	if (file_exists($conf[\'path\'])) {
		$dirHandler = opendir($conf[\'path\']);
	}else {
		return false;
	}
	$err = false;
	$fs_dirs = [];
	
	while (($file = readdir($dirHandler)) !== false) {
        if ($file == \'.\' || $file == \'..\' ) continue;
		if (is_dir($conf[\'path\'].$file)) {
			$fs_dirs[] = $file;
		}
	}
	
	if (count($fs_dirs) > 0) {
		$newDirs = array_diff($fs_dirs , $catList);
	}

	if (count($newDirs) > 0) {
		foreach($newDirs AS $val) {
			$sql = "INSERT INTO ".$modx->getFullTableName( \'categories\' )." (id, category) VALUES (NULL , \'".$val."\')";
			$result = $modx->db->query($sql);
			if ($result) {
				$sql_last = "SELECT id FROM ".$modx->getFullTableName( \'categories\' )." WHERE category = \'".$val."\' ";
				$result_last = $modx->db->query($sql_last);
				if ($result_last) {
					if ($lastId = $modx->db->getRow($result_last)) {
						$catList[$lastId[\'id\'] ] = $val;
					}
				}
			}else {
				$err = true;
			}
		}
	}

	if ($err) {
		return false;
	} else {
		if (count($newDirs) > 0) {
			return $newDirs;
		} else {
			return true;
		}
	}
}







function makeDir ($catList , $conf) {
	$err = false;
	if (count($catList) > 0) {
		if (!file_exists($conf[\'path\'])) {
			if (!mkdir ($conf[\'path\'])) {
				$err = true;
			}
		} 
		foreach ($catList AS $key => $value){
			if (!file_exists($conf[\'path\'].$value)) {
				if (!mkdir ($conf[\'path\'].$value, 0777, true)){
					$err = true;
					break;
				}
			}	
		}
	} else {	
		$err = true;
	}
	if ($err) {
		return false;
	} else {
		return true;
	}
}







function sync ($modx , $conf , $catList) {

	if (count($catList) < 1) return false;
	$sql = "SELECT * FROM ".$modx->getFullTableName( \'site_snippets\' )." LIMIT 500";
	$result = $modx->db->query($sql);
	if ($result && $modx->db->getRecordCount($result) > 0 ) {
		$dateSyncFileHandler = fopen ($conf[\'path\'].\'___SyncDATE.log\' , \'a+\');
		$logDataArr = [];
		$logData = @fread($dateSyncFileHandler, filesize($conf[\'path\'].\'___SyncDATE.log\'));	
		$logData = explode(PHP_EOL,$logData);
		
		if (count($logData) > 0){
			foreach ($logData AS $tmp){
				$tmp = explode("::" , $tmp);
				$logDataArr[ $tmp[0] ] = $tmp[1];
			}
		}
		$refreshProcess = false;
		while ($row = $modx->db->getRow($result)){
			$snp_path = $conf[\'path\'].$catList[ $row[\'category\'] ].\'/\'.$row[\'name\'].\'.php\';
			if (file_exists($snp_path)){
				if (filemtime($snp_path) > $logDataArr[$row[\'name\'].\'.php\' ]) {	
					if (refreshDBsnippet($modx , $snp_path, $row[\'name\'], $catList) === true){
						$refreshProcess = true;
					}
				}	
			} else {
				$fileHandler = fopen ($snp_path , \'a+\');
				if ($fileHandler) {
					fwrite($fileHandler , "<?php".PHP_EOL.$row[\'snippet\'].PHP_EOL."?>");
					fclose($fileHandler);
				}
				fwrite($dateSyncFileHandler , $row[\'name\'].\'::\'.filemtime($snp_path).PHP_EOL);
			}
		}
		fclose($dateSyncFileHandler);
	}
	if ($refreshProcess) {
		return true;
	} else return false;
}





function refreshDBsnippet($modx , $snp_path, $snp_name,  $catList) {
	$snp_code =  file($snp_path);
	$snp_code[0] = \'\';
	$snp_code[count($snp_code) -1 ] = \'\';
	$snp_code = implode("", $snp_code);
	$snp_code = $modx->db->escape($snp_code);
	
	$sql = "UPDATE ".$modx->getFullTableName( \'site_snippets\' )." SET snippet = \'".$snp_code."\' WHERE name = \'".$snp_name."\' LIMIT 1";
	$result = $modx->db->query($sql) or die ("ERR 564 ".$modx->db->getLastError());
	
	if ($result){
		clearCache_px($modx);
		return true;
	} else {
		return false;
	}
}





function clearCache_px($modx) {
	$modx->clearCache();
	include_once MODX_BASE_PATH . \'manager/processors/cache_sync.class.processor.php\';
	$sync= new synccache();
	$sync->setCachepath( MODX_BASE_PATH . "assets/cache/" );
	$sync->setReport( false );
	$sync->emptyCache();
}







function rewriteLog($path , $conf , $outMNG) {

	if ($outMNG) {
		$upPath = \'../\';
	}else {
		$upPath = \'\';
	}
	
	$dirHandler = opendir($path);
	while (($file = readdir($dirHandler)) !== false) {
        if ($file == \'.\' || $file == \'..\' ) continue;
		if (is_dir($path.$file)) {
			rewriteLog($path.$file.\'/\', $conf , $outMNG);
		}else {
			$fp = fopen($upPath.$conf[\'path\'].\'___SyncDATE.log\' , \'a\');
			fwrite($fp , $file.\'::\'.filemtime($path.$file).PHP_EOL);
			fclose($fp);
		}
    }
	return true;
}';$p['syncSnippetsProps']='{}';$p['ajxControl']='$headers = getallheaders();
if ($headers[\'X-Requested-With\'] == \'XMLHttpRequest\' && $headers[\'px-FormSender\'] == \'true\') {
	
	if (is_array($_POST) && count($_POST)) {
		foreach($_POST AS $key => $json){
			if ($key == \'meta\') {
				$meta =  json_decode($json , 1);
				continue;
			}
			$jdata = json_decode($json , 1) ;
			$fields_pholder[$key] = $jdata [\'fieldname\'];
			$values_pholder[$key] = $jdata [\'value\'];
		}
	}
	
	if (is_array($fields_pholder) && is_array($values_pholder) && count($fields_pholder) && count($fields_pholder) == count($values_pholder) && $meta[\'chunk\'] != \'\') {
		if ($meta[\'subject\'] == \'\') $meta[\'subject\'] = \'Писмо с сайта \'.$_SERVER[\'HTTP_HOST\'];
		
		$parsedChunk = $modx->parseText($modx->getChunk(\'testForm_Mail\') , $fields_pholder , \'[+pxField.\');
		$parsedChunk = $modx->parseText($parsedChunk , $values_pholder , \'[+pxValue.\');
		$parsedChunk = $modx->rewriteUrls($parsedChunk);
		$respond[\'debug\'] = $parsedChunk;
		$respond[\'result\'] = true;
		$modx->runSnippet(\'sendQuickEmail\' , array(
			\'subject\' => $meta[\'subject\'], 
			\'clientMail\' => \'\' , //todo
			\'emailtext\' => $parsedChunk,
			\'clientOnly\' => false, //todo
			) 
		);
		}else {
		$respond[\'resultpx\'] = false;
	
	}
	sleep(1);
	echo json_encode($respond);
	exit();
}';$p['ajxControlProps']='{}';$e=&$this->pluginEvent;$e['OnBeforeDocFormSave']=array('ManagerManager');$e['OnBeforeManagerLogin']=array('Forgot Manager Login');$e['OnBeforePluginFormSave']=array('FileSource');$e['OnBeforeSnipFormSave']=array('FileSource');$e['OnChunkFormDelete']=array('ElementsInTree');$e['OnChunkFormRender']=array('CodeMirror');$e['OnChunkFormSave']=array('ElementsInTree');$e['OnDocDuplicate']=array('ManagerManager');$e['OnDocFormPrerender']=array('ManagerManager');$e['OnDocFormRender']=array('ManagerManager','CodeMirror');$e['OnDocFormSave']=array('ManagerManager');$e['OnInterfaceSettingsRender']=array('TinyMCE4');$e['OnLoadWebDocument']=array('TinyMCE4');$e['OnLoadWebPageCache']=array('TinyMCE4');$e['OnManagerAuthentication']=array('Forgot Manager Login');$e['OnManagerLoginFormRender']=array('Forgot Manager Login');$e['OnManagerMainFrameHeaderHTMLBlock']=array('ElementsInTree');$e['OnManagerTreePrerender']=array('ElementsInTree');$e['OnManagerTreeRender']=array('ElementsInTree');$e['OnManagerWelcomeHome']=array('Updater');$e['OnModFormDelete']=array('ElementsInTree');$e['OnModFormRender']=array('CodeMirror');$e['OnModFormSave']=array('ElementsInTree');$e['OnPageNotFound']=array('Updater');$e['OnParseDocument']=array('TinyMCE4');$e['OnPluginFormDelete']=array('ElementsInTree');$e['OnPluginFormPrerender']=array('FileSource');$e['OnPluginFormRender']=array('FileSource','CodeMirror','ManagerManager');$e['OnPluginFormSave']=array('ElementsInTree');$e['OnRichTextEditorInit']=array('TinyMCE4','CodeMirror');$e['OnRichTextEditorRegister']=array('TinyMCE4');$e['OnSiteRefresh']=array('Updater');$e['OnSnipFormDelete']=array('ElementsInTree');$e['OnSnipFormPrerender']=array('FileSource');$e['OnSnipFormRender']=array('CodeMirror','FileSource');$e['OnSnipFormSave']=array('ElementsInTree','syncSnippets');$e['OnStripAlias']=array('TransAlias');$e['OnTempFormDelete']=array('ElementsInTree');$e['OnTempFormRender']=array('CodeMirror');$e['OnTempFormSave']=array('ElementsInTree');$e['OnTVFormDelete']=array('ElementsInTree');$e['OnTVFormRender']=array('ManagerManager');$e['OnTVFormSave']=array('ElementsInTree');$e['OnWebPageInit']=array('syncSnippets');$e['OnWebPagePrerender']=array('TinyMCE4','test');
